    def _clean_number(self, value: str) -> float | None:
        if not value:
            return None
        cleaned = value.replace('\xa0', '').replace(' ', '').replace('B', '').strip()
        if cleaned.count(',') > 1 and '.' not in cleaned:
            cleaned = cleaned.replace(',', '')
        cleaned = cleaned.replace(',', '.')
        cleaned = re.sub(r'[^\d\.-]', '', cleaned)
        if not cleaned:
            return None
        try:
            return float(cleaned)
        except ValueError:
            return None

    def _parse_quantity_price(self, text: str) -> tuple[float, float] | None:
        try:
            parts = text.lower().split('x')
            if len(parts) != 2:
                return None
            qty = self._clean_number(parts[0])
            price = self._clean_number(parts[1])
            if qty is None or price is None:
                return None
            return qty, price
        except Exception:
            return None

    def _parse_amount(self, text: str) -> tuple[float | None, str | None]:
        """
        Extract numeric amount and detect currency label from text snippets like
        "13.50 B" or "1018,79 MDL"
        """
        if not text:
            return None, None

        currency = None
        upper_text = text.upper()
        if 'MDL' in upper_text or 'LEI' in upper_text:
            currency = 'MDL'
        elif upper_text.endswith(' B') or upper_text.endswith('B'):
            currency = 'MDL'

        amount = self._clean_number(text)
        return amount, currency
